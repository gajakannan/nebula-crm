{
  "permissions": {
    "allow": [
      "WebSearch",
      "Bash(chmod:*)",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:raw.githubusercontent.com)",
      "Bash(done)",
      "Bash(ls:*)",
      "Bash(wc:*)",
      "Bash(head:*)",
      "Bash(find:*)",
      "Bash(tree:*)",
      "Bash(echo:*)",
      "Bash(git checkout:*)",
      "Bash(grep:*)",
      "Bash(agents/architect/references/architecture-examples.md <<'EOFA'\n# Architecture Examples\n\nReal-world architecture examples across different domains. Use these as templates when designing your specific solution.\n\n---\n\n## Example 1: E-commerce Order Management System\n\n### Order Entity Specification\n\n**Table Name:** `Orders`\n\n**Description:** Represents a customer order with line items.\n\n#### Fields\n\n| Field | Type | Constraints | Default | Description |\n|-------|------|-------------|---------|-------------|\n| Id | Guid | PK, NOT NULL | NewGuid\\(\\) | Unique identifier |\n| OrderNumber | string\\(50\\) | NOT NULL, UNIQUE | - | Human-readable order number \\(ORD-2026-001234\\) |\n| CustomerId | Guid | FK → Customers, NOT NULL | - | Customer who placed order |\n| Status | string\\(20\\) | NOT NULL | 'Pending' | Pending, Processing, Shipped, Delivered, Cancelled |\n| OrderDate | DateTime | NOT NULL | UtcNow | When order was placed |\n| TotalAmount | decimal\\(18,2\\) | NOT NULL | - | Order total \\(sum of line items\\) |\n| ShippingAddress | string\\(500\\) | NOT NULL | - | Delivery address |\n| PaymentMethod | string\\(50\\) | NOT NULL | - | CreditCard, PayPal, BankTransfer |\n| PaymentStatus | string\\(20\\) | NOT NULL | 'Pending' | Pending, Paid, Refunded |\n| CreatedAt | DateTime | NOT NULL | UtcNow | UTC timestamp |\n| CreatedBy | Guid | NOT NULL | - | System or user who created |\n| UpdatedAt | DateTime | NOT NULL | UtcNow | UTC timestamp |\n| UpdatedBy | Guid | NOT NULL | - | User who last updated |\n\n#### Relationships\n\n- **One-to-Many:** Order → OrderItems \\(cascade delete\\)\n- **Many-to-One:** Order → Customer \\(restrict delete if orders exist\\)\n\n#### Indexes\n\n- `IX_Orders_OrderNumber` \\(UNIQUE\\)\n- `IX_Orders_CustomerId`\n- `IX_Orders_Status`\n- `IX_Orders_OrderDate`\n\n#### Audit Requirements\n\n- All mutations create `ActivityTimelineEvent`\n- Events: OrderCreated, OrderStatusChanged, OrderCancelled\n- Timeline includes before/after state for updates\n\n### Order Workflow State Machine\n\n**States:**\n- Pending \\(initial\\) → Processing → Shipped → Delivered \\(terminal\\)\n- Pending → Cancelled \\(terminal\\)\n\n**Allowed Transitions:**\n\n| From | To | Prerequisites | Authorization |\n|------|----|---------------|---------------|\n| Pending | Processing | Payment confirmed | System, Admin |\n| Processing | Shipped | Items picked, label generated | WarehouseStaff, Admin |\n| Shipped | Delivered | Carrier confirms delivery | System |\n| Pending | Cancelled | No payment or customer request | Customer, Admin |\n| Processing | Cancelled | Customer request before shipment | Admin only |\n\n**Validation Rules:**\n\n**Processing → Shipped:**\n- All order items must be picked\n- Shipping label must be generated\n- Carrier tracking number must exist\n\n**Error Responses:**\n\n\\\\`\\\\`\\\\`json\n{\n  \"code\": \"INVALID_TRANSITION\",\n  \"message\": \"Cannot ship order. Items not yet picked.\",\n  \"details\": {\n    \"currentStatus\": \"Processing\",\n    \"attemptedStatus\": \"Shipped\",\n    \"missingRequirements\": [\"Items not picked\"]\n  }\n}\n\\\\`\\\\`\\\\`\n\n### Order API Contract\n\n\\\\`\\\\`\\\\`yaml\nopenapi: 3.0.0\npaths:\n  /api/orders:\n    post:\n      summary: Create a new order\n      operationId: createOrder\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              type: object\n              required: [customerId, items, shippingAddress]\n              properties:\n                customerId:\n                  type: string\n                  format: uuid\n                items:\n                  type: array\n                  items:\n                    type: object\n                    properties:\n                      productId:\n                        type: string\n                        format: uuid\n                      quantity:\n                        type: integer\n                        minimum: 1\n                      price:\n                        type: number\n                        format: decimal\n                shippingAddress:\n                  type: string\n                paymentMethod:\n                  type: string\n                  enum: [CreditCard, PayPal, BankTransfer]\n      responses:\n        '201':\n          description: Order created successfully\n        '400':\n          description: Validation error\n        '402':\n          description: Payment required\n        '409':\n          description: Inventory conflict \\(out of stock\\)\n\n  /api/orders/{id}/status:\n    put:\n      summary: Update order status\n      parameters:\n        - name: id\n          in: path\n          required: true\n          schema:\n            type: string\n            format: uuid\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              type: object\n              required: [status]\n              properties:\n                status:\n                  type: string\n                  enum: [Processing, Shipped, Delivered, Cancelled]\n                trackingNumber:\n                  type: string\n                  description: Required when transitioning to Shipped\n      responses:\n        '200':\n          description: Status updated successfully\n        '409':\n          description: Invalid status transition\n\\\\`\\\\`\\\\`\n\n### Authorization Policies\n\n**Casbin Policies:**\n\n\\\\`\\\\`\\\\`\n# Customers can create orders and view their own orders\np, Customer, Order, Create, allow\np, Customer, Order, Read, allow, sub.userId == res.customerId\n\n# WarehouseStaff can update order status \\(Processing → Shipped\\)\np, WarehouseStaff, Order, Update, allow, res.status in [\"Processing\", \"Shipped\"]\n\n# Admins can do everything\np, Admin, Order, *, allow\n\\\\`\\\\`\\\\`\n\n---\n\n## Example 2: Content Management System - Article Workflow\n\n### Article Entity Specification\n\n**Table Name:** `Articles`\n\n**Fields:**\n\n| Field | Type | Constraints | Description |\n|-------|------|-------------|-------------|\n| Id | Guid | PK | Unique identifier |\n| Title | string\\(255\\) | NOT NULL | Article title |\n| Slug | string\\(255\\) | UNIQUE, NOT NULL | URL-friendly slug |\n| Content | text | NULL | Article body \\(markdown\\) |\n| AuthorId | Guid | FK → Users | Author |\n| Status | string\\(20\\) | NOT NULL | Draft, InReview, Published, Archived |\n| PublishedAt | DateTime | NULL | When published |\n| CreatedAt | DateTime | NOT NULL | Creation timestamp |\n| UpdatedAt | DateTime | NOT NULL | Last update timestamp |\n\n### Article Workflow\n\n**States:**\n- Draft \\(initial\\) → InReview → Published \\(terminal\\)\n- Draft → Archived \\(terminal\\)\n\n**Allowed Transitions:**\n\n| From | To | Prerequisites |\n|------|----|---------------|\n| Draft | InReview | Title and content populated |\n| InReview | Draft | Editor requests changes |\n| InReview | Published | Editor approval |\n| Published | Archived | Author or editor archives |\n\n---\n\n## Example 3: SaaS Subscription Management\n\n### Subscription Entity\n\n**Table Name:** `Subscriptions`\n\n**Fields:**\n\n| Field | Type | Constraints | Description |\n|-------|------|-------------|-------------|\n| Id | Guid | PK | Subscription ID |\n| CustomerId | Guid | FK → Customers | Customer |\n| PlanId | Guid | FK → Plans | Subscription plan \\(Starter, Pro, Enterprise\\) |\n| Status | string\\(20\\) | NOT NULL | Active, Suspended, Cancelled, Expired |\n| BillingCycle | string\\(20\\) | NOT NULL | Monthly, Yearly |\n| StartDate | DateTime | NOT NULL | Subscription start |\n| EndDate | DateTime | NULL | Subscription end \\(null = ongoing\\) |\n| NextBillingDate | DateTime | NOT NULL | Next charge date |\n| MRR | decimal\\(18,2\\) | NOT NULL | Monthly Recurring Revenue |\n\n### Subscription Workflow\n\n**States:**\n- Active → Suspended \\(payment failed\\) → Active \\(payment recovered\\)\n- Active → Cancelled → Expired \\(terminal\\)\n\n**Business Rules:**\n- Cannot cancel if in trial period \\(trial cancels automatically\\)\n- Cannot downgrade mid-cycle \\(takes effect next billing date\\)\n- Suspend after 3 failed payment attempts\n- Expire 30 days after cancellation \\(grace period\\)\n\n---\n\n## How to Use These Examples\n\n1. Select a domain relevant to your solution \\(or create your own\\)\n2. Follow the structure \\(Entity → Workflow → API → Authorization\\)\n3. Adapt field names and relationships to your domain\n4. Keep patterns consistent across all entities in your system\n5. Reference these examples when designing new modules\n\n---\n\n## For Project-Specific Architecture\n\nSee your project's `planning-mds/examples/architecture/` directory for architecture examples specific to your solution.\n\n---\n\n## Version History\n\n**Version 2.0** - 2026-02-01 - Generic examples \\(separated from solution-specific content\\)\n**Version 1.0** - Initial version\nEOFA)",
      "Bash(git add:*)"
    ]
  }
}
